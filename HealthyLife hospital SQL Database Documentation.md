## **HealthyLife hospital SQL Database Documentation**

### **Project Overview**

Developing a database system that will support daily hospital operations and decision-making. The database will store information on patients, general practitioners (GPs), admissions, diagnoses, specialties, wards, and methods of admission.

The goals of this database are:

* To record and track patient admissions.  
* To capture diagnoses linked to admissions.  
* To associate patients with GPs and practices.  
* To support insights on hospital utilization and diagnoses.

**Database Structure**

1. **Database Creation**

*CREATE DATABASE HealthyLife\_Hospital;*  
*USE HealthyLife\_Hospital;*

2. **Table Schemas**

* **Patients Table**   
- Stores patient demographic information.  
- Fields: PatientID (PK), ForeName, SurName, DateOfBirth, Gender, PostCode.  
- Populated with 100 randomized records using a loop and name pools.  
- **Data Context**: Names randomly selected from declared tables; DOB generated by subtracting random days; Gender alternates between Male and Female; PostCode generated as 'PC' \+ zero-padded ID.

* **Specialty Table**  
- Stores different medical specialties offered in the hospital.  
- Fields: SpecialtyCode (PK), SpecialtyName.  
- Manually Populated with 5 specialties: Cardiology, Neurology, Pediatrics, General Medicine, and Surgery.  
- **Data Context**: Manually inserted.

* **Ward Table**  
- Contains information about different wards and their types.  
- Fields: WardCode (PK), WardName, WardType.  
- Manually populated with 5 wards: General, ICU, Maternity, Endoscopy Suite, and Emergency.  
- **Data Context**: Manually inserted.

* **MethodOfAdmission Table**  
- Defines the various ways a patient can be admitted.  
- Fields: MethodOfAdmissionCode (PK), MethodOfAdmissionType.  
- Manually Populated with 3 admission types: Emergency, Elective, and GP Referral.  
- **Data Context**: Manually inserted

* **GPPractice Table**  
- Stores data about GP clinics/practices.  
- Fields: GPPracticeCode (PK), PracticeName, PracticePostCode.  
- Manually Populated with 5 GP practices.  
- **Data Context**: Manually inserted with unique practice names and mock postcodes for locality representation.

* **GP Table**  
- Lists general practitioners and their associated practices.  
- Fields: GPCode (PK), GPName, GPPracticeCode (FK).  
- Manually Populated with 10 GPs.  
- **Data Context:** Each GP is manually linked to a valid GPPracticeCode; names selected for diversity and realism.

* **Admission Table**  
- Records details of patient admissions to the hospital.  
- Fields: AdmissionID (PK), PatientID (FK), AdmissionDate, DischargeDate, SpecialtyCode (FK), WardCode (FK), MethodOfAdmissionCode (FK).  
- Populated with 100 randomized records.  
- **Data Context**: Randomly links patients to specialties, wards, and methods of admission; AdmissionDate is randomized within the past year; DischargeDate is set 1–14 days later.

* **Diagnosis Table**  
- Stores diagnoses linked to specific hospital admissions.  
- Fields: DiagnosisCode (PK), DiagnosisDescription, AdmissionID (FK).  
- Populated with 100 diagnosis records.  
- **Data Context**: Each diagnosis is linked to a unique AdmissionID; DiagnosisDescription rotates through a set of 10 common illnesses for variability.

3. **Query Implementation & Analysis**

1. **Patient and Admission Details**  
* **Patient details**

Retrieved each patient’s basic demographic information including full name, gender, date of birth, and postcode from the Patients table.

* **Total Number of Admissions per Patient**

Used *LEFT JOIN* between *Patients* and *Admission*  tables to calculate the total number of times each patient has been admitted. Ensures all patients are included, even if they have no admissions.

***Note:** The financial years (2014/15 and 2015/16) are based on the scenario. However, the sample dataset used for development only contains recent dates, so the query may return no results unless adjusted to match actual data ranges – which is what I did.*

2. **Admission Analysis**  
* **Maximum Length of Stay (2023/24) for Elective Admissions to Endoscopy Suite**

Retrieved the maximum number of days a patient stayed in the hospital (Length of Stay) in the 2023/24 financial year, specifically for admissions to the **Endoscopy Suite** ward and via the **Elective** method.

*Note: This query returned no results for the 2023/24 financial year due to no elective admissions into the Endoscopy Suite during that time period in the dataset. The logic was retained to demonstrate analytical capability and can be reused with future data.*

* **Total Admissions by Ward (2024/25)**

Retrieves the number of admissions per ward for the **2024/25** financial year, grouped by ward name and ordered by total admissions in descending order.

3. **GP and Practice Analysis**  
* **Objective**

Identify the GP Practice responsible for the highest number of hospital admissions referred by GPs during the financial year 2024/25

* ### **Data Context**

- To support this analysis, the Patients  table was updated to include a foreign key column GP Code linking each patient to a GP

- Out of 100 patients, **32 had no GP assigned** (*GPCode \= NULL*), simulating real-world scenarios such as emergency or elective admissions without GP involvement.

- The remaining **68 patients** were randomly assigned to GPs for mock data purposes.

***Note**:The random assignment simulates real-world scenarios where patients may be admitted via emergency, elective procedures, or may not be registered with a GP.*

* ***Query used***

This query retrieves the GP Practice responsible for the highest number of hospital admissions referred by GPs during the financial year 2024/25. It joins the *`Admission`*, *`MethodOfAdmission`*, *`Patients`*, *`GP`*, and *`GPPractice`* tables, using the *`GPCode`* column to trace each patient’s registered GP and their corresponding practice.

*`SELECT`*   
    *`gpp.PracticeName,`*  
    *`COUNT(*) AS TotalAdmissions`*  
*`FROM Admission a`*  
*`JOIN MethodOfAdmission m ON a.MethodOfAdmissionCode = m.MethodOfAdmissionCode`*  
*`JOIN Patients p ON a.PatientID = p.PatientID`*  
*`JOIN GP g ON p.GPCode = g.GPCode`*  
*`JOIN GPPractice gpp ON g.GPPracticeCode = gpp.GPPracticeCode`*  
*`WHERE`*   
    *`a.AdmissionDate BETWEEN '2024-04-01' AND '2025-03-31'`*  
    *`AND m.MethodOfAdmissionType = 'GP Referral'`*  
*`GROUP BY gpp.PracticeName`*  
*`ORDER BY TotalAdmissions DESC`*`;`

4. **Readmission pattern**  
* **Objective**

Analyze hospital admission episodes to identify cases where a patient is readmitted via emergency within 7 days of discharge from an elective admission, under the same specialty.

*`SELECT`*  
    *`a1.PatientID,`*  
    *`a1.AdmissionID AS FirstAdmissionID,`*  
    *`a1.DischargeDate AS FirstDischargeDate,`*  
    *`m1.MethodOfAdmissionType AS FirstAdmissionMethod,`*  
    *`a1.SpecialtyCode AS FirstSpecialtyCode,`*  
    *`a2.AdmissionID AS SecondAdmissionID,`*  
    *`a2.AdmissionDate AS SecondAdmissionDate,`*  
    *`m2.MethodOfAdmissionType AS SecondAdmissionMethod,`*  
    *`a2.SpecialtyCode AS SecondSpecialtyCode,`*  
    *`DATEDIFF(DAY, a1.DischargeDate, a2.AdmissionDate) AS DaysBetween`*  
*`FROM Admission a1`*  
*`JOIN Admission a2 ON a1.PatientID = a2.PatientID AND a1.AdmissionID <> a2.AdmissionID`*  
*`JOIN MethodOfAdmission m1 ON a1.MethodOfAdmissionCode = m1.MethodOfAdmissionCode`*  
*`JOIN MethodOfAdmission m2 ON a2.MethodOfAdmissionCode = m2.MethodOfAdmissionCode`*  
*`WHERE`*   
    *`a2.AdmissionDate > a1.DischargeDate`*  
    *`AND DATEDIFF(DAY, a1.DischargeDate, a2.AdmissionDate) <= 7`*  
    *`AND m1.MethodOfAdmissionType = 'Elective'`*  
    *`AND m2.MethodOfAdmissionType = 'Emergency'`*  
    *`AND a1.SpecialtyCode = a2.SpecialtyCode;`*

**Data Logic:** This query identifies cases where patients were readmitted via emergency shortly after being discharged from an elective procedure. Such patterns may indicate complications, poor post-discharge follow-up, or early recurrence of conditions.

***Note:** When run **without the `WHERE` clause**, the query returns combinations of any two admission episodes per patient – regardless of method, specialty, or time gap.*  
*However, once the `WHERE` conditions are applied (especially the admission methods and 7-day rule), the query may return **no results** due to data limitations in the mock dataset.*  
*This reflects the limitations of the sample/mock data, not an error in the logic – it simply means that no patient in the current data matches all the specified criteria.*

5. **Additional Data Retrieval**  
1. **Patients with more than 1 Admission (2024/25)**  
* **Objective**

Retrieve all patients who had more than one hospital admission in the 2024/25 financial year.

* **Query**  
  *`SELECT PatientID`*  
  *`FROM Admission`*  
  *`WHERE AdmissionDate BETWEEN '2024-04-01' AND '2025-03-31'`*  
  *`GROUP BY PatientID`*  
  *`HAVING COUNT(*) > 1;`*

**Data Logic:** Useful for identifying high-utilization patients, indicating chronic conditions or repeated hospital care.

2. **Average Length of Stay by Ward (2024/25)**  
* **Objective**

Calculate the average length of hospital stays for each ward during FY 2024/25.

* **Query**  
  *`SELECT`*   
      *`WardCode,`*  
      *`AVG(DATEDIFF(DAY, AdmissionDate, DischargeDate)) AS AvgLengthOfStay`*  
  *`FROM Admission`*  
  *`WHERE AdmissionDate BETWEEN '2024-04-01' AND '2025-03-31'`*  
  *`GROUP BY WardCode;`*

**Data Logic:** This helps evaluate patient turnover rates and ward-level efficiency or care intensity.

3. **Top 5 Specialties by Admission Volume (2024/25)**  
* **Objective**

Top 5 specialties with the highest number of admissions during FY 2024/25

* **Query**  
  *`SELECT`*   
      *`SpecialtyCode,`*  
      *`COUNT(*) AS NumAdmissions`*  
  *`FROM Admission`*  
  *`WHERE AdmissionDate BETWEEN '2024-04-01' AND '2025-03-31'`*  
  *`GROUP BY SpecialtyCode`*  
  *`ORDER BY NumAdmissions DESC`*  
  *`OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY;`*

**Data Logic:** Supports strategic planning by identifying high-demand specialties.

4. **GP with Most Patients Admitted (2024/25)**  
* **Objective**

GP with the highest number of distinct patients admitted in FY 2024/25

* **Query**  
  *`SELECT`*   
      *`g.GPName,`*  
      *`COUNT(DISTINCT a.PatientID) AS NumPatientsAdmitted`*  
  *`FROM Admission a`*  
  *`JOIN Patients p ON a.PatientID = p.PatientID`*  
  *`JOIN GP g ON p.GPCode = g.GPCode`*  
  *`WHERE a.AdmissionDate BETWEEN '2024-04-01' AND '2025-03-31'`*  
  *`GROUP BY g.GPName`*  
  *`ORDER BY NumPatientsAdmitted DESC;`*

**Data Logic:** Highlights GPs with high hospital referral rates, which may indicate patient load or GP practice size.

5. **ICU Admissions and Diagnoses**  
* **Objective**

Patients admitted to the ICU ward along with their diagnoses.

* **Query**  
  *`SELECT`*   
      *`p.PatientID,`*  
      *`p.ForeName + ' ' + p.SurName AS FullName,`*  
      *`a.AdmissionID,`*  
      *`w.WardName,`*  
      *`d.DiagnosisDescription`*  
  *`FROM Admission a`*  
  *`JOIN Patients p ON a.PatientID = p.PatientID`*  
  *`JOIN Ward w ON a.WardCode = w.WardCode`*  
  *`JOIN Diagnosis d ON a.AdmissionID = d.AdmissionID`*  
  *`WHERE w.WardType = 'ICU';`*

**Data logic:** Enables review of critical care cases and their medical reasons, useful for ICU planning or clinical analysis.